function showHelp(){document.getElementById("helpOpen").style.display="none";document.getElementById("helpClose").style.display="";document.getElementById("help").style.display=""}function hideHelp(){document.getElementById("helpOpen").style.display="";document.getElementById("helpClose").style.display="none";document.getElementById("help").style.display="none"}let notesElement=document.getElementById("notes"),isResize=!1,currentX,currentY,endX,endY,sourceElement=undefined,selectedElement=undefined;const pointerDown=n=>{currentX=n.clientX||n.changedTouches[0].pageX;currentY=n.clientY||n.changedTouches[0].pageY;const t=n.srcElement.offsetWidth,i=n.srcElement.offsetHeight,r=n.offsetX||n.changedTouches[0].screenX-n.changedTouches[0].clientX,u=n.offsetY||n.changedTouches[0].screenY-n.changedTouches[0].clientY;selectedElement=sourceElement=n.srcElement;isResize=r>=t*.7&&u>=i*.7;n.preventDefault()},pointerMove=n=>{if(sourceElement!==undefined){const t=n.clientX||n.changedTouches[0].pageX,i=n.clientY||n.changedTouches[0].pageY;if(endX=currentX-t,endY=currentY-i,currentX=t,currentY=i,isResize){const n=Math.floor(sourceElement.style.width.replace("px","")),t=Math.floor(sourceElement.style.height.replace("px",""));sourceElement.style.width=`${n-endX}px`;sourceElement.style.height=`${t-endY}px`}else sourceElement.style.top=`${sourceElement.offsetTop-endY}px`,sourceElement.style.left=`${sourceElement.offsetLeft-endX}px`}},pointerUp=n=>{sourceElement=undefined,n.preventDefault()};document.addEventListener("pointermove",pointerMove);document.addEventListener("pointerup",pointerUp);let protocol=new signalR.JsonHubProtocol,hubRoute="Notes",connection=(new signalR.HubConnectionBuilder).withUrl(hubRoute).withAutomaticReconnect().withHubProtocol(protocol).build();const addNote=n=>{let t=document.createElement("div");t.innerText=n;t.className="stickynote";t.style.width="100px";t.style.height="100px";t.style.transform=`rotateZ(${Math.floor(Math.random()*8)-4}deg)`;t.addEventListener("pointerdown",pointerDown);t.addEventListener("dblclick",()=>{let n=prompt("Add note",t.innerText);t.innerText=n});notesElement.insertBefore(t,notesElement.firstChild)},showNoteDialog=()=>{for(;;){let n=prompt("Add note");if(n===undefined||n==null||n.length===0)break;addNote(n)}};window.addEventListener("focus",()=>{});window.addEventListener("blur",()=>{});window.addEventListener("mouseup",()=>{console.log("window mouseup")});window.addEventListener("contextmenu",n=>{n.preventDefault(),sourceElement===undefined&&showNoteDialog()});connection.on("notes",function(n){let t="Date received: "+(new Date).toLocaleTimeString();t+="\n"+n.body;addMessage(t)});connection.onclose(function(n){n?addMessage("Connection closed with error: "+n):addMessage("Disconnected")});connection.start().then(function(){}).catch(function(n){addMessage(n)});document.addEventListener("keyup",n=>{n.key==="Escape"||(n.key==="Backspace"||n.key==="Delete"?selectedElement!==undefined&&(notesElement.removeChild(selectedElement),selectedElement=undefined):n.key==="Alt"||n.altKey||showNoteDialog())});